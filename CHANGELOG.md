# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

**Types Of Changes:**

- Added for new features.
- Changed for changes in existing functionality.
- Deprecated for soon-to-be removed features.
- Removed for now removed features.
- Fixed for any bug fixes.
- Security in case of vulnerabilities.

**Git Commands:**
List: git tag
Create: git tag -a <tag_name> -m '<tag_message>'
Upload: git push origin --tags
Delete tag: git tag -d <tag_name>

## Notice

## [Unreleased]
### Changed
- Schema::buildColumn now can create mediumtext,longtext columns
- notices, warning etc will no longer throw exception
- Created Json/Xml view objects

### Fixed
- Fixed transaction already started errors
- Fixed Schema adding null when creating table
- Fixed entity:toXml of using incorrect name property


## [1.20.0] - 2019-06-30
Some internal reorganization occurred, moving Cache,Storage and Queue, and rewriting Logger. (See migration guide, to upgrade)
The focus now will resume on increasing code coverage closer to 100%, bug fixes, if any, testing for security vulnerabilities, maybe adding SQLite engine.

### Migration Guide to 1.20

Some internal changes have made that will trigger a deprecation warning in debug mode. In particular Cache,Storage which use engines and Queue will use engines in future, and these have been put into their own folders.

- Rename references `Origin\Utility\Cache` to `Origin\Cache\Cache`. In `config/application.php` there is reference to this.
- Rename references `Origin\Utility\Storage` to `Origin\Storage\Storage`
- Rename references `Origin\Utility\Queue` to `Origin\Storage\Queue`
- If you have used logger `Core\Logger`, then use the new `Log\Log` library.

- If you have used `Cache::use` them then adjust to use `Cache::store`
- If you have used `Storage::use` then adjust to use `Storage::volume`

- In your console integration tests change methods `$this->errorOutput(` to `$this->error(`

### Deprecated

- `Core\Logger` been deprecated use `Log\Log` instead
- `Utility\Cache` been deprecated use `Cache\Cache` instead
- `Utility\Storage` been deprecated use `Storage\Storage` instead
- `Utility\Queue` been deprecated use `Queue\Queue` instead
- `Cache::use` deprecated use `Cache::store` instead
- `Storage:use` deprecated use `Storage::volume` instead
- `ConsoleIntegrationTestTrait::errorOutput` deprecated use `ConsoleIntegrationTestTrait::error` instead

### Changed

- Cleaned up and refactored Database engines
- Cache can now pass array of options
- Storage can now pass array of options

### Added

- Cache::store for getting configured cache store
- Storage::volume for getting configured storage volume
- Added all styles for POSIX levels in ConsoleOutput

### Fixed
- Fixed Dropping tables using Pgsql when foreignKeys are involved
- Storage FTP engine changed default mode to passive (default used nowdays)
- CommandTest changed output to RAW
- Fixed Fixture manager default behavior was not dropping tables between tests
- Fixed issue with console ProgressBar not being cleared
- Fixed Locale Generator prompting overwrite on files not just directory
- Fixed issue #55 - ConsoleApp Stop Execution Not Caught

## [1.19.0] - 2019-06-26
A small breakage for any code generated by the generator before this release.  Public setUp and public tearDown  were used instead of protected. Simply adjust those to protected setUp():void and protected tearDown():void
### Added
- travis ci caching of composer files and autodeploy on tagged releases

### Fixed
- Changed PHPUnit setUp / tearDown functions to protected as per the manual.

## [1.18.5] - 2019-06-26
### Added
- Database engines now have databases and tables

### Changed
- Updated travis CI settings
- Refactored DB command unit tests to work test on both mysql and pgsql
- Memcached/Redis unit tests now skip if incomplete settings are provided

## [1.18.4] - 2019-06-26
### Added
- Added Travis.yml

### Fixed
- Fixed issue with with view that plugin name was not being underscored
- Fixed DbSchemaDumpCommandTest to work with older versions of MYSQL
- Fixed ModelTest fail on older version of MySQL due to order
- Fixed Folder/file testing on different systems
- Fixed bug in testGenerateScaffold where it was using default datasource instead of test
- Fixed issue with Http test failing when running on different ip address

### Changed
- Memcached/Redis tests now use ENV vars for configuration
- Migration renameColumn now compatible with versions less than 8.0
- Database Connection Exception message now displayed in error, it is needed.
- Move phpunit.xml to root in preparation for travis
- Changed the composer.json to suggest memcached

## [1.18.3] - 2019-06-25
### Changed
- Refactored phpunit settings to work with env vars
- Console progress bar now works with and without ansi support
- Renamed phpunit.xml to phpunit.xml.dist
- Prepared cookie for Cookie.key

### Fixed
- Fixed .gitignore to reflect properly since splitting into composer packages
- Added Locale reset to Intl Number/Date tests
- Fixed File::group/Folder::group returning null on non linux systems
- NumberTest,DebugerTest, LocalesGeneratorTest, FolderTest fixed fails on different os
- Database exception errors when connecting were not being logged
- Issues with test hashes caused by last refactor Security.salt renamed to Security.pepper

## [1.18.2] - 2019-06-24
### Fixed
- Cookie tests
- Accidentally committed debug code

### Deprecated
- Security.salt and Security::hash option salt. This is now renamed to `pepper` as per the correct terminology

#### Security
- Cookie key was larger than openssl function would use and was truncated

## [1.18.1] - 2019-06-24
### Added
- Security hashPassword, verifyPassword
- Security compare for comparing hashed strings to protect against timing attacks

### Fixed
- String functions contains,begins,ends, length etc changed to multibyte
- Removed not used argument description

### Changed
- Composer.json - cleaned this up and improved
- CSRF Protection Middleware token changed to use the Security::hash function
- Security::hash now uses array of options
- Refactored Auth component to work with Security::verifyPassword
- Changed Cookie classes to work with refactored security utility
- Security encrypt returns base64 encoded string, a decrypt expects that.
- Security hash now throws exception if Algo is not known
- Html2Text now supports more headings, lists, definitions, blockquotes
- Removed unnecessary array access from collections

### Security
- Switched to random_bytes from openssl_random_pseudo_bytes
- Refactored Security::encrypt/decrypt added protection against timing attacks
- CSRF Protection Middleware, added protection against timing attacks
- File Utility switched to internal uid function for unique id generation
- Form Helper changed to escape values for protection against Cross-Site Scripting (XSS) attacks
- Adjusted h function work better for security
- Improved Email Utility for protection against Email Header Injection Attacks